<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Strength & Posture Routine</title>
    <link rel="preconnect" href="https://media1.tenor.com">
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --bg-main: #0d1117;
        --bg-card: #161b22;
        --border: #30363d;
        --text-main: #c9d1d9;
        --accent: #2563eb;
      }
      body {
        font-family: "Inter", sans-serif;
        background-color: var(--bg-main);
        color: var(--text-main);
      }
      
      /* SECTION STYLES */
      .section-header {
        background-color: var(--bg-card);
        cursor: pointer;
        border-left: 4px solid var(--accent);
        border-bottom: 1px solid var(--border);
        transition: background 0.2s;
      }
      .section-header:hover { background-color: #21262d; }
      
      /* EXERCISE DROPDOWN STYLES */
      .exercise-header {
        background-color: #21262d; /* Slightly lighter than section */
        cursor: pointer;
        border-bottom: 1px solid var(--border);
        padding: 12px 16px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .exercise-header:hover { background-color: #30363d; }
      
      .exercise-content {
        background-color: #0d1117;
        border-bottom: 1px solid var(--border);
      }

      .meta-tag {
         background: #238636;
         color: white;
         font-size: 0.75rem;
         padding: 2px 8px;
         border-radius: 12px;
         margin-left: 10px;
         white-space: nowrap;
      }

      .cue-box {
        border-left: 3px solid #58a6ff;
        background: rgba(88, 166, 255, 0.1);
        padding: 10px;
        margin-top: 10px;
        border-radius: 0 4px 4px 0;
        font-size: 0.9rem;
        color: #f0f6fc;
      }

      .card-img-top {
        width: 100%;
        height: auto;
        min-height: 200px;
        background: #0d1117;
        border-radius: 4px;
        object-fit: contain; /* Ensures entire GIF is visible */
      }
      
      /* Spinner for visual feedback */
      .loader {
        position: fixed; top:0; left:0; width:100%; height:100%;
        background: rgba(13,17,23,0.95);
        display: flex; justify-content: center; align-items: center;
        z-index: 9999; transition: opacity 0.3s;
      }
      .loader.hidden { opacity: 0; pointer-events: none; }
      .spinner {
        width: 40px; height: 40px;
        border: 4px solid #30363d; border-top: 4px solid var(--accent);
        border-radius: 50%; animation: spin 1s linear infinite;
      }
      @keyframes spin { 100% { transform: rotate(360deg); } }
    </style>
  </head>
  <body class="p-3 p-md-4">
    <div id="loader" class="loader"><div class="spinner"></div></div>

    <div class="container" style="max-width: 600px">
      <h1 class="text-center fw-bold mb-2 text-white">Strength & Posture</h1>
      <p class="text-center small text-secondary mb-4">Click sections to expand • Click exercises to view demo</p>

      <div id="routine-container"></div>
      
      <div class="mt-4 text-center small text-secondary">
        Rest 60s between rounds • 3s down, 1s up
      </div>
    </div>

    <script>
      window.addEventListener('load', () => {
        setTimeout(() => document.getElementById('loader').classList.add('hidden'), 300);
      });

      const exerciseData = [
        // PART 1
        { section: "Part 1: Warm-Up (Required)", name: "Cat-Cow Stretch", reps: "1 min", cue: "Inhale arching back, exhale rounding spine.", gif: "https://media1.tenor.com/m/LPwFzdwK9AEAAAAd/cat-cow-stretch.gif" },
        { section: "Part 1: Warm-Up (Required)", name: "Glute Bridges", reps: "2x15", cue: "Drive through heels, squeeze glutes at top.", gif: "https://media1.tenor.com/m/WAhbRzWse3wAAAAC/gym.gif" },
        { section: "Part 1: Warm-Up (Required)", name: "World's Greatest Stretch", reps: "5/side", cue: "Lunge forward, rotate arm to ceiling.", gif: "https://media.self.com/photos/682f678832db37eeee7cbadb/master/w_1600%2Cc_limit/winnie-worlds-greatest-stretch%2520(1).gif" },

        // PART 2
        { section: "Part 2: Circuit A (Back & Legs)", name: "Dumbbell RDL", reps: "10-12", cue: "Hinge hips back. Keep back flat like a table.", gif: "https://media1.tenor.com/m/APh12ekUwcIAAAAd/dumbbell-deadlift.gif" },
        { section: "Part 2: Circuit A (Back & Legs)", name: "Bent-Over Rows", reps: "10-12", cue: "Pull weights to pockets, squeeze blades.", gif: "https://media1.tenor.com/m/ZA7d-cdoYEIAAAAd/bentoverrows.gif" },
        { section: "Part 2: Circuit A (Back & Legs)", name: "Reverse Lunges", reps: "10/leg", cue: "Step back, drop knee straight down.", gif: "https://media1.tenor.com/m/ahYtJQbVUP0AAAAd/reverse-lunges-home-workouts.gif" },
        { section: "Part 2: Circuit A (Back & Legs)", name: "Superman Holds", reps: "10 reps", cue: "Lift chest/thighs. Hold 3s.", gif: "https://media1.tenor.com/m/BpWq8HxUxeAAAAAd/lumbaresms.gif" },

        // PART 3
        { section: "Part 3: Circuit B (Core)", name: "Goblet Squat", reps: "10-12", cue: "Hold weight at chest. Elbows inside knees.", gif: "https://media1.tenor.com/m/1NY6qOs30XIAAAAC/goblet-squad.gif" },
        { section: "Part 3: Circuit B (Core)", name: "Overhead Press", reps: "8-10", cue: "Tight core. Don't arch back.", gif: "https://media1.tenor.com/m/T_vqvD5qG-YAAAAC/shoulder-press-seated-shoulder-press.gif" },
        { section: "Part 3: Circuit B (Core)", name: "Single-Leg Bridge", reps: "12/leg", cue: "One foot planted. Drive hips up.", gif: "https://media1.tenor.com/m/wfa9Tp6Spz8AAAAd/single-leg.gif" },
        { section: "Part 3: Circuit B (Core)", name: "Bird-Dog", reps: "10/side", cue: "Opposite arm/leg. Balance water on back.", gif: "https://media1.tenor.com/m/6nO5406JCHIAAAAC/bird-dog.gif" },

        // PART 4
        { section: "Part 4: Stretching", name: "Pigeon Pose", reps: "45s", cue: "Shin parallel. Sink hips.", gif: "https://bodybyyoga.training/wp-content/uploads/2021/10/Pigeon-Pose-Yoga-1536x1024.png" },
        { section: "Part 4: Stretching", name: "Child's Pose", reps: "45s", cue: "Hips to heels. Reach forward.", gif: "https://media1.tenor.com/m/G6UOVsD9bs4AAAAC/workout-working-out.gif" }
      ];

      const container = document.getElementById("routine-container");
      
      // Group Data
      const routineBySection = exerciseData.reduce((acc, ex) => {
        if (!acc[ex.section]) acc[ex.section] = [];
        acc[ex.section].push(ex);
        return acc;
      }, {});

      // Render
      for (const section in routineBySection) {
        const exercises = routineBySection[section];
        const secId = section.replace(/[^a-zA-Z0-9]/g, ""); // Clean ID

        let exercisesHtml = exercises.map((ex, index) => {
            const exId = secId + index;
            return `
                <div class="exercise-item">
                    <div class="exercise-header" onclick="toggleExercise('${exId}')">
                        <span class="fw-bold text-white small">${ex.name} <span class="meta-tag">${ex.reps}</span></span>
                        <span id="icon-${exId}" class="text-secondary small">▼</span>
                    </div>
                    <div id="${exId}" class="exercise-content p-3 d-none">
                        <img class="card-img-top lazy-gif" 
                             src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" 
                             data-src="${ex.gif}" 
                             alt="${ex.name}" 
                             loading="lazy" 
                             decoding="async">
                        <div class="cue-box">${ex.cue}</div>
                    </div>
                </div>
            `;
        }).join("");

        container.innerHTML += `
            <div class="mb-3 rounded overflow-hidden">
                <div class="section-header p-3 d-flex justify-content-between align-items-center" onclick="toggleSection('${secId}')">
                    <h2 class="mb-0 fs-6 fw-bold text-white">${section}</h2>
                    <span id="icon-${secId}" class="text-secondary">▼</span>
                </div>
                <div id="${secId}" class="d-none">
                    ${exercisesHtml}
                </div>
            </div>
        `;
      }

      // Logic: Show Section List
      function toggleSection(id) {
        const el = document.getElementById(id);
        const icon = document.getElementById(`icon-${id}`);
        if (el.classList.contains("d-none")) {
            el.classList.remove("d-none");
            icon.innerText = "▲";
        } else {
            el.classList.add("d-none");
            icon.innerText = "▼";
        }
      }

      // Logic: Load GIF & Show Details
      function toggleExercise(id) {
        const el = document.getElementById(id);
        const icon = document.getElementById(`icon-${id}`);
        const img = el.querySelector('img');

        if (el.classList.contains("d-none")) {
            // Lazy Load Trigger
            if (img.dataset.src) {
                img.src = img.dataset.src;
                img.removeAttribute('data-src');
            }
            el.classList.remove("d-none");
            icon.innerText = "▲";
        } else {
            el.classList.add("d-none");
            icon.innerText = "▼";
        }
      }
    </script>
  </body>
</html>
